# 📖 使用说明 - 编辑代理功能

## ✅ 问题已修复

**Bug：** 编辑线路时报错"线路名称存在"  
**状态：** ✅ 已完全修复  
**版本：** v2.2.0

---

## 🎯 现在可以正常使用的功能

### 1. 编辑代理（不修改名称）
✅ **现在可以直接保存，不会再报"名称已存在"的错误**

```
操作步骤：
1. 访问 http://localhost:5000
2. 切换到"代理管理"标签
3. 点击任意代理的"编辑"按钮
4. 修改其他配置（如服务器、端口等）
5. 点击"保存"

结果：✅ 更新成功！
```

---

### 2. 编辑代理（修改名称）
✅ **名称验证正确，不会误判为重复**

```
操作步骤：
1. 点击代理的"编辑"按钮
2. 修改代理名称为一个新的名称
3. 点击"保存"

结果：
- ✅ 名称验证正确（排除当前代理自身）
- ✅ 策略组中的引用自动更新
- ✅ 配置文件保存成功
```

---

### 3. 删除代理
✅ **删除操作正确，不会误删其他代理**

```
操作步骤：
1. 点击代理的"删除"按钮
2. 确认删除

结果：✅ 删除正确的代理
```

---

## 🔧 技术改进

### 原理
- **旧版本**：使用列表索引来标识代理（容易出错）
- **新版本**：使用代理名称来标识代理（准确可靠）

### API 变化
新增了基于名称的 API 端点：
- `PUT /api/proxies/by-name/<proxy_name>` - 更新代理
- `DELETE /api/proxies/by-name/<proxy_name>` - 删除代理

原有的基于索引的 API 仍然可用（向后兼容）。

---

## 📝 注意事项

1. **代理名称唯一性**：确保每个代理的名称都是唯一的
2. **中转线路**：中转线路和普通代理使用相同的编辑逻辑
3. **自动推送**：编辑或删除后会自动推送配置到已连接的设备

---

## 🎊 祝您使用愉快！

如有任何问题，请查看日志文件：`logs/proxy_manager.log`

