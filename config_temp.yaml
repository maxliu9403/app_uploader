# ==================== åŸºç¡€è®¾ç½® ====================
socks-port: 7891
mixed-port: 7890
tproxy-port: 9898
redir-port: 9797
allow-lan: true
mode: rule
# ç”Ÿäº§ç¯å¢ƒå»ºè®® warningï¼Œå‡å°‘ IO
log-level: warning
ipv6: false
external-controller: 0.0.0.0:9090
secret: ''
external-ui: ./dashboard

# ==================== æ€§èƒ½ä¸æŒ‡çº¹ ====================
tcp-concurrent: true
# æ¨¡æ‹Ÿ Android ç½‘ç»œæŒ‡çº¹
global-client-fingerprint: android
keep-alive-interval: 30
# å¼ºåˆ¶è®© UDP æµé‡æ’é˜Ÿï¼Œé˜²æ­¢ QUIC æŠ¢å å¸¦å®½å¯¼è‡´ä¸¢åŒ…
unified-delay: true

# ==================== DNS è®¾ç½® (å…³é”®ä¿®æ­£) ====================
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  
  # å¼•å¯¼ DNS: å›½å†… IP ç”¨äºå¿«é€Ÿè§£æèŠ‚ç‚¹åŸŸå (Trojan Server)
  default-nameserver: 
    - 223.5.5.5
    - 119.29.29.29
  
  # ä¸šåŠ¡ DNS: è§£å†³ Chrome è®¿é—®å¤±è´¥çš„æ ¸å¿ƒ
  # âŒ é”™è¯¯åšæ³•: ä½¿ç”¨ https://dns.google (DoH)ã€‚åœ¨å›½å†…æ¡æ‰‹ææ˜“è¶…æ—¶ -> ERR_NAME_NOT_RESOLVED
  # âœ… æ­£ç¡®åšæ³•: ä½¿ç”¨æ™®é€šçš„ UDP 8.8.8.8ã€‚è¯·æ±‚ä¼šå°è£…åœ¨ä»£ç†éš§é“é‡Œï¼Œé˜²æ±¡æŸ“ä¸”é€Ÿåº¦æå¿«ã€‚
  nameserver: 
    - 8.8.8.8
    - 1.1.1.1
    
  fallback: 
    - 8.8.8.8
    - 1.1.1.1
  
  fallback-filter: 
    geoip: true
    ipcidr: [240.0.0.0/4]
  
  fake-ip-filter: 
    - '+.arxlabs.io'
    - 'connect.rom.miui.com'
    - 'time.android.com'
    - 'time.google.com'

# ==================== Tun æ¨¡å¼ (æ ¸å¿ƒ) ====================
tun:
  # ğŸ”¥ å¿…é¡»å¼€å¯: å¦åˆ™æµé‡æ²¡æœ‰ä»»ä½•æ¥ç®¡ï¼ŒChrome è‡ªç„¶æ— æ³•ä¸Šç½‘
  enable: true
  stack: gvisor
  auto-route: true
  auto-detect-interface: true
  dns-hijack: [any:53]
  mtu: 1400 # æ‰‹æœºç½‘ç»œæœ€ä½³å…¼å®¹å€¼
  
  # ğŸ”¥ ä¸¥æ ¼è·¯ç”±ï¼šé˜²æ­¢æµé‡ç»•è¿‡ä»£ç†
  strict-route: true
  
  # ğŸ”¥ IP ä¼ªè£…ï¼šä½¿ç”¨ 198.18 ç½‘æ®µï¼Œå½»åº•é¿å¼€ docker/172.x.x.x ç‰¹å¾
  inet4-address: [198.18.0.1/30]
  
  # å½»åº•ç¦ç”¨ IPv6 æ¥å£ï¼Œé˜²æ­¢ leak
  inet6-address: []

# ==================== èŠ‚ç‚¹åˆ—è¡¨ ====================
proxies:
 
 
# ==================== ç­–ç•¥ç»„ ====================
proxy-groups:
  - name: "Proxy-IP"
    type: select
    proxies:
    
       
# ==================== è§„åˆ™ ====================
rules:
  # ========== 1. æ ¸å¿ƒé˜²æŠ¤ (ä¼˜å…ˆçº§æœ€é«˜) ==========
  # WebRTC STUN/TURN å…¨ç«¯å£é˜»æ–­ (é˜²æ­¢æ³„éœ²å†…ç½‘ IP)
  - DST-PORT,3478-3497,REJECT
  # IPv6 å…¨é˜»æ–­ (é˜²æ­¢ IPv6 æ³„éœ²çœŸå® IP)
  - IP-CIDR6,::/0,REJECT,no-resolve
  # QUIC/UDP 443 é˜»æ–­ (å¼ºåˆ¶ Chrome/App èµ° TCP)
  - AND,((NETWORK,UDP),(DST-PORT,443)),REJECT

  # ========== 2. æ—¶é—´åŒæ­¥ (é˜²æ—¶åŒºæ³„éœ²) ==========
  # å¼ºåˆ¶ NTP èµ°ä»£ç†ï¼Œæˆ–è€…ç›´æ¥ REJECT è®©ç³»ç»Ÿä½¿ç”¨è¢«åŠ«æŒçš„æ—¶é—´
  - DST-PORT,123,Proxy-IP
  - DOMAIN-SUFFIX,ntp.org,Proxy-IP
  - DOMAIN-SUFFIX,time.google.com,Proxy-IP
  - DOMAIN-SUFFIX,time.android.com,Proxy-IP

  # ========== 3. IP æ£€æµ‹ç½‘ç«™ (ç¡®ä¿çœ‹åˆ°çš„æ˜¯ä»£ç† IP) ==========
  - DOMAIN-SUFFIX,ipinfo.io,Proxy-IP
  - DOMAIN-SUFFIX,ip-api.com,Proxy-IP
  - DOMAIN-SUFFIX,whoer.net,Proxy-IP
  - DOMAIN-SUFFIX,browserleaks.com,Proxy-IP
  - DOMAIN-SUFFIX,api.ip.sb,Proxy-IP

  # ========== 4. ä¸šåŠ¡åº”ç”¨ ==========
  # Carousell
  - DOMAIN-KEYWORD,carousell,Proxy-IP
  - DOMAIN-SUFFIX,carousell.com,Proxy-IP
  - DOMAIN-SUFFIX,carousell.com.hk,Proxy-IP
  - DOMAIN-SUFFIX,media.carousell.com,Proxy-IP
  
  # Vinted
  - DOMAIN-KEYWORD,vinted,Proxy-IP
  - DOMAIN-SUFFIX,vinted.com,Proxy-IP
  - DOMAIN-SUFFIX,vinted.co.uk,Proxy-IP
  - DOMAIN-SUFFIX,vinted.fr,Proxy-IP

  # ========== 5. Google / Android åŸºç¡€æœåŠ¡ ==========
  # è¿™äº›å¿…é¡»èµ°ä»£ç†ï¼Œå¦åˆ™ GMS æ— æ³•è¿æ¥
  - DOMAIN-SUFFIX,googleapis.com,Proxy-IP
  - DOMAIN-SUFFIX,gstatic.com,Proxy-IP
  - DOMAIN-SUFFIX,google.com,Proxy-IP
  - DOMAIN-SUFFIX,ggpht.com,Proxy-IP
  - DOMAIN-SUFFIX,googleusercontent.com,Proxy-IP
  
  # ========== 6. å›½å†…ç›´è¿ (æœ€å°åŒ–) ==========
  - GEOIP,CN,DIRECT
  - GEOSITE,CN,DIRECT
  
  # ========== 7. å…œåº• ==========
  - MATCH,Proxy-IP